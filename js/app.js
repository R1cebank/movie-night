(function() {
  var ip;

  ip = require('ip');

  angular.module('Movie-Night', ['Movie-Night.client', 'Movie-Night.server', 'Movie-Night.videoServer']).directive('mnScrollBottom', function() {
    return {
      restrict: 'A',
      link: function(scope, el, attr) {
        return scope.$watchCollection(attr.mnScrollBottom, function() {
          return el[0].scrollTop = el[0].scrollHeight;
        });
      }
    };
  }).directive('mnOnSeek', function() {
    return {
      restrict: 'A',
      link: function(scope, element, attr) {
        return $(element).on('seeked', function() {
          return scope.$eval(attr.mnOnSeek, {
            time: element[0].currentTime
          });
        });
      }
    };
  }).directive('mnOnPlay', function() {
    return {
      restrict: 'A',
      link: function(scope, element, attr) {
        return $(element).on('play', function() {
          return scope.$eval(attr.mnOnPlay);
        });
      }
    };
  }).directive('mnOnPause', function() {
    return {
      restrict: 'A',
      link: function(scope, element, attr) {
        return $(element).on('pause', function() {
          return scope.$eval(attr.mnOnPause);
        });
      }
    };
  }).directive('mnControl', function() {
    return {
      restrict: 'A',
      scope: {
        control: '=mnControl'
      },
      link: function(scope, element, attr) {
        var elm;
        scope.control.time = 0;
        scope.control.playing = false;
        elm = element[0];
        scope.$watch('control.playing', function(newValue) {
          if (elm.readyState !== 0) {
            if (newValue) {
              console.log('playing called');
              return elm.play();
            } else {
              return elm.pause();
            }
          }
        });
        $(element).on('play', function() {
          scope.control.playing = true;
          return scope.$apply();
        });
        $(element).on('pause', function() {
          scope.control.playing = false;
          return scope.$apply();
        });
        scope.$watch('control.time', function(newValue, oldValue) {
          if (elm.readyState !== 0 && Math.abs(newValue - oldValue) > 1.0) {
            return elm.currentTime = newValue;
          }
        });
        return $(element).on('timeupdate', function() {
          scope.control.time = elm.currentTime;
          return scope.$apply();
        });
      }
    };
  }).controller('MainController', function($scope, MnClient, MnServer, MnVideoServer) {
    $scope.messages = [];
    $scope.player = {
      time: 0,
      playing: false
    };
    MnClient.on('connected', function(data) {
      return $scope.connected = true;
    });
    MnClient.on('uuid', function(data) {
      return console.log('recived id:' + data.data);
    });
    MnClient.on('message', function(data) {
      console.log('client got: ');
      console.log(data);
      $scope.messages.push(data);
      return $scope.$digest();
    });
    MnClient.on('played', function(data) {
      console.log(data);
      $scope.player.playing = true;
      return $scope.$digest();
    });
    MnClient.on('paused', function(data) {
      console.log(data);
      $scope.player.playing = false;
      return $scope.$digest();
    });
    MnClient.on('videoServerStarted', function(data) {
      console.log('video loaded');
      return document.getElementById("videoWindow").load();
    });
    MnClient.on('seeked', function(data) {
      console.log('recived seeked time ' + data.data);
      $scope.player.time = data.data;
      return $scope.$digest();
    });
    $scope.createServer = function() {
      $scope.showIPInput = false;
      MnServer.start();
      MnClient.join(ip.address(), '3939', 'admin');
      $scope.ip = ip.address();
      return $scope.videoPath = 'http://' + ip.address() + ':1337';
    };
    $scope.submitIP = function(ip) {
      console.log(ip);
      return MnClient.join(ip, '3939');
    };
    $scope.submitMessage = function() {
      var tempMsg;
      tempMsg = {
        type: 'msg',
        data: $scope.messageInput,
        timestamp: new Date().getTime()
      };
      MnClient.sendMsg(tempMsg);
      $scope.messageInput = '';
      console.log('client sent');
      return console.log(tempMsg);
    };
    $scope.onseek = function(time) {
      var tempMsg;
      tempMsg = {
        type: 'seeked',
        data: time,
        timestamp: new Date().getTime()
      };
      return MnClient.sendEvent(tempMsg);
    };
    $scope.videoPlayed = function() {
      var tempMsg;
      tempMsg = {
        type: 'played',
        data: '',
        timestamp: new Date().getTime()
      };
      return MnClient.sendEvent(tempMsg);
    };
    $scope.videoPaused = function() {
      var tempMsg;
      tempMsg = {
        type: 'paused',
        data: '',
        timestamp: new Date().getTime()
      };
      return MnClient.sendEvent(tempMsg);
    };
    return $scope.file_changed = function(element) {
      var tempMsg;
      console.log(element.files[0].path);
      MnVideoServer.start(element.files[0].path);
      tempMsg = {
        type: 'videoServerStarted',
        data: '',
        timestamp: new Date().getTime()
      };
      return MnClient.sendEvent(tempMsg);
    };
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,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QSxPQUFBLEdBQ0U7QUFBQSxRQUFBLElBQUEsRUFBTSxvQkFBTjtBQUFBLFFBQ0EsSUFBQSxFQUFNLEVBRE47QUFBQSxRQUVBLFNBQUEsRUFBZSxJQUFBLElBQUEsQ0FBQSxDQUFNLENBQUMsT0FBUCxDQUFBLENBRmY7T0FIRixDQUFBO2FBTUEsUUFBUSxDQUFDLFNBQVQsQ0FBbUIsT0FBbkIsRUFQb0I7SUFBQSxFQTlFTTtFQUFBLENBM0RoQyxDQUhBLENBQUE7QUFBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJpcCA9IHJlcXVpcmUgJ2lwJ1xuXG5cbmFuZ3VsYXIubW9kdWxlICdNb3ZpZS1OaWdodCcsIFsnTW92aWUtTmlnaHQuY2xpZW50JywgJ01vdmllLU5pZ2h0LnNlcnZlcicsICdNb3ZpZS1OaWdodC52aWRlb1NlcnZlciddXG4gIC5kaXJlY3RpdmUgJ21uU2Nyb2xsQm90dG9tJywgLT5cbiAgICByZXN0cmljdDogJ0EnXG4gICAgbGluazogKHNjb3BlLCBlbCwgYXR0cikgLT5cbiAgICAgIHNjb3BlLiR3YXRjaENvbGxlY3Rpb24gYXR0ci5tblNjcm9sbEJvdHRvbSwgLT5cbiAgICAgICAgZWxbMF0uc2Nyb2xsVG9wID0gZWxbMF0uc2Nyb2xsSGVpZ2h0XG5cbiAgLmRpcmVjdGl2ZSAnbW5PblNlZWsnLCAtPlxuICAgIHJlc3RyaWN0OiAnQSdcbiAgICBsaW5rOiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIC0+XG4gICAgICAkKGVsZW1lbnQpLm9uICdzZWVrZWQnLCAtPlxuICAgICAgICBzY29wZS4kZXZhbCBhdHRyLm1uT25TZWVrLCB0aW1lOiBlbGVtZW50WzBdLmN1cnJlbnRUaW1lXG5cbiAgLmRpcmVjdGl2ZSAnbW5PblBsYXknLCAtPlxuICAgIHJlc3RyaWN0OiAnQSdcbiAgICBsaW5rOiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIC0+XG4gICAgICAkKGVsZW1lbnQpLm9uICdwbGF5JywgLT5cbiAgICAgICAgc2NvcGUuJGV2YWwgYXR0ci5tbk9uUGxheVxuXG4gIC5kaXJlY3RpdmUgJ21uT25QYXVzZScsIC0+XG4gICAgcmVzdHJpY3Q6ICdBJ1xuICAgIGxpbms6IChzY29wZSwgZWxlbWVudCwgYXR0cikgLT5cbiAgICAgICQoZWxlbWVudCkub24gJ3BhdXNlJywgLT5cbiAgICAgICAgc2NvcGUuJGV2YWwgYXR0ci5tbk9uUGF1c2VcblxuICAuZGlyZWN0aXZlICdtbkNvbnRyb2wnLCAtPlxuICAgIHJlc3RyaWN0OiAnQSdcbiAgICBzY29wZTpcbiAgICAgIGNvbnRyb2w6ICc9bW5Db250cm9sJ1xuICAgIGxpbms6IChzY29wZSwgZWxlbWVudCwgYXR0cikgLT5cbiAgICAgIHNjb3BlLmNvbnRyb2wudGltZSA9IDBcbiAgICAgIHNjb3BlLmNvbnRyb2wucGxheWluZyA9IG5vXG5cbiAgICAgIGVsbSA9IGVsZW1lbnRbMF1cbiAgICAgIHNjb3BlLiR3YXRjaCAnY29udHJvbC5wbGF5aW5nJywgKG5ld1ZhbHVlKSAtPlxuICAgICAgICBpZiBlbG0ucmVhZHlTdGF0ZSBpc250IDBcbiAgICAgICAgICBpZiBuZXdWYWx1ZVxuICAgICAgICAgICAgY29uc29sZS5sb2cgJ3BsYXlpbmcgY2FsbGVkJ1xuICAgICAgICAgICAgZWxtLnBsYXkoKVxuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIGVsbS5wYXVzZSgpXG5cbiAgICAgICQoZWxlbWVudCkub24gJ3BsYXknICwgLT5cbiAgICAgICAgc2NvcGUuY29udHJvbC5wbGF5aW5nID0geWVzXG4gICAgICAgIHNjb3BlLiRhcHBseSgpXG5cbiAgICAgICQoZWxlbWVudCkub24gJ3BhdXNlJyAsIC0+XG4gICAgICAgIHNjb3BlLmNvbnRyb2wucGxheWluZyA9IG5vXG4gICAgICAgIHNjb3BlLiRhcHBseSgpXG5cbiAgICAgIHNjb3BlLiR3YXRjaCAnY29udHJvbC50aW1lJywgKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgLT5cblxuICAgICAgICBpZiBlbG0ucmVhZHlTdGF0ZSBpc250IDAgYW5kIE1hdGguYWJzKG5ld1ZhbHVlIC0gb2xkVmFsdWUpID4gMS4wXG4gICAgICAgICAgZWxtLmN1cnJlbnRUaW1lID0gbmV3VmFsdWVcblxuICAgICAgJChlbGVtZW50KS5vbiAndGltZXVwZGF0ZScsIC0+XG4gICAgICAgIHNjb3BlLmNvbnRyb2wudGltZSA9IGVsbS5jdXJyZW50VGltZVxuICAgICAgICBzY29wZS4kYXBwbHkoKVxuXG4gIC5jb250cm9sbGVyICdNYWluQ29udHJvbGxlcicsICgkc2NvcGUsIE1uQ2xpZW50LCBNblNlcnZlciwgTW5WaWRlb1NlcnZlcikgLT5cblxuICAgICRzY29wZS5tZXNzYWdlcyA9IFtdXG4gICAgJHNjb3BlLnBsYXllciA9IHRpbWU6IDAsIHBsYXlpbmc6IG5vXG5cbiAgICBNbkNsaWVudC5vbiAnY29ubmVjdGVkJywgKGRhdGEpIC0+XG4gICAgICAkc2NvcGUuY29ubmVjdGVkID0geWVzXG5cbiAgICBNbkNsaWVudC5vbiAndXVpZCcsIChkYXRhKSAtPlxuICAgICAgY29uc29sZS5sb2cgJ3JlY2l2ZWQgaWQ6JyArIGRhdGEuZGF0YVxuXG4gICAgTW5DbGllbnQub24gJ21lc3NhZ2UnLCAoZGF0YSkgLT5cbiAgICAgIGNvbnNvbGUubG9nICdjbGllbnQgZ290OiAnXG4gICAgICBjb25zb2xlLmxvZyBkYXRhXG4gICAgICAkc2NvcGUubWVzc2FnZXMucHVzaChkYXRhKVxuICAgICAgJHNjb3BlLiRkaWdlc3QoKVxuXG4gICAgTW5DbGllbnQub24gJ3BsYXllZCcsIChkYXRhKSAtPlxuICAgICAgY29uc29sZS5sb2cgZGF0YVxuICAgICAgJHNjb3BlLnBsYXllci5wbGF5aW5nID0geWVzXG4gICAgICAkc2NvcGUuJGRpZ2VzdCgpXG5cbiAgICBNbkNsaWVudC5vbiAncGF1c2VkJywgKGRhdGEpIC0+XG4gICAgICBjb25zb2xlLmxvZyBkYXRhXG4gICAgICAkc2NvcGUucGxheWVyLnBsYXlpbmcgPSBub1xuICAgICAgJHNjb3BlLiRkaWdlc3QoKVxuXG4gICAgTW5DbGllbnQub24gJ3ZpZGVvU2VydmVyU3RhcnRlZCcsIChkYXRhKSAtPlxuICAgICAgY29uc29sZS5sb2cgJ3ZpZGVvIGxvYWRlZCdcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9XaW5kb3dcIikubG9hZCgpXG5cbiAgICBNbkNsaWVudC5vbiAnc2Vla2VkJywgKGRhdGEpIC0+XG4gICAgICBjb25zb2xlLmxvZyAncmVjaXZlZCBzZWVrZWQgdGltZSAnICsgZGF0YS5kYXRhXG4gICAgICAkc2NvcGUucGxheWVyLnRpbWUgPSBkYXRhLmRhdGFcbiAgICAgICRzY29wZS4kZGlnZXN0KClcblxuICAgICRzY29wZS5jcmVhdGVTZXJ2ZXIgPSAtPlxuICAgICAgJHNjb3BlLnNob3dJUElucHV0ID0gbm9cbiAgICAgIE1uU2VydmVyLnN0YXJ0KClcbiAgICAgIE1uQ2xpZW50LmpvaW4gaXAuYWRkcmVzcygpLCAnMzkzOScsICdhZG1pbidcbiAgICAgICRzY29wZS5pcCA9IGlwLmFkZHJlc3MoKVxuICAgICAgJHNjb3BlLnZpZGVvUGF0aCA9ICdodHRwOi8vJyArIGlwLmFkZHJlc3MoKSArICc6MTMzNydcblxuICAgICRzY29wZS5zdWJtaXRJUCA9IChpcCkgLT5cbiAgICAgIGNvbnNvbGUubG9nIGlwXG4gICAgICBNbkNsaWVudC5qb2luIGlwLCAnMzkzOSdcblxuICAgICRzY29wZS5zdWJtaXRNZXNzYWdlID0gLT5cbiAgICAgIHRlbXBNc2cgPVxuICAgICAgICB0eXBlOiAnbXNnJ1xuICAgICAgICBkYXRhOiAkc2NvcGUubWVzc2FnZUlucHV0XG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICAgIE1uQ2xpZW50LnNlbmRNc2cgdGVtcE1zZ1xuICAgICAgJHNjb3BlLm1lc3NhZ2VJbnB1dCA9ICcnXG4gICAgICBjb25zb2xlLmxvZyAnY2xpZW50IHNlbnQnXG4gICAgICBjb25zb2xlLmxvZyB0ZW1wTXNnXG5cbiAgICAkc2NvcGUub25zZWVrID0gKHRpbWUpIC0+XG4gICAgICB0ZW1wTXNnID1cbiAgICAgICAgdHlwZTogJ3NlZWtlZCdcbiAgICAgICAgZGF0YTogdGltZVxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICBNbkNsaWVudC5zZW5kRXZlbnQgdGVtcE1zZ1xuXG4gICAgJHNjb3BlLnZpZGVvUGxheWVkID0gLT5cbiAgICAgIHRlbXBNc2cgPVxuICAgICAgICB0eXBlOiAncGxheWVkJ1xuICAgICAgICBkYXRhOiAnJ1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICBNbkNsaWVudC5zZW5kRXZlbnQgdGVtcE1zZ1xuXG4gICAgJHNjb3BlLnZpZGVvUGF1c2VkID0gLT5cbiAgICAgIHRlbXBNc2cgPVxuICAgICAgICB0eXBlOiAncGF1c2VkJ1xuICAgICAgICBkYXRhOiAnJ1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gICAgICBNbkNsaWVudC5zZW5kRXZlbnQgdGVtcE1zZ1xuXG4gICAgJHNjb3BlLmZpbGVfY2hhbmdlZCA9IChlbGVtZW50KS0+XG4gICAgICBjb25zb2xlLmxvZyBlbGVtZW50LmZpbGVzWzBdLnBhdGhcbiAgICAgIE1uVmlkZW9TZXJ2ZXIuc3RhcnQgZWxlbWVudC5maWxlc1swXS5wYXRoXG4gICAgICB0ZW1wTXNnID1cbiAgICAgICAgdHlwZTogJ3ZpZGVvU2VydmVyU3RhcnRlZCdcbiAgICAgICAgZGF0YTogJydcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuICAgICAgTW5DbGllbnQuc2VuZEV2ZW50IHRlbXBNc2dcbiJdfQ==